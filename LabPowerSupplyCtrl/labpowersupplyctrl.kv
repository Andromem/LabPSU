
<ChannelControl>:
    #canvas.after:
    #    Color:
    #        rgb: (1,1,0)
    #    Line:
    #        width: 5
    #        rounded_rectangle: self.x+5,self.y+5,self.width-10,self.height-10,40

    orientation: 'vertical'
    Label:
        id: output_voltage
        font_size: 50
        text: "%2.3fV" % root.output_voltage
        color: [1,0,0,1] if root.in_current_limit else [0.5,0.5,0.5,1] if not root.enabled else [0,1,0,1]

    Label:
        id: output_current
        font_size: 50
        text: "%1.4fA" % root.output_current
        color: [1,0,0,1] if root.in_current_limit else [0.5,0.5,0.5,1] if not root.enabled else [0,1,0,1]

    Label:
        id: output_power
        font_size: 50
        text: "%2.3fW" % (root.output_current * root.output_voltage)
        color: [1,0,0,1] if root.in_current_limit else [0.5,0.5,0.5,1] if not root.enabled else [0,1,0,1]

    GridLayout:
        canvas.after:
            Line:
                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
        cols: 2
        Button:
            text: 'Set Voltage'
            on_press: root.set_voltage_clicked()
        Label:
            text: "%2.3fV" % root.set_voltage
        Button:
            text: 'Set Current'
            on_press: root.set_current_clicked()
        Label:
            text: "%1.4fA" % root.set_current
    Button:
        id: enableButton
        font_size: 50
        text: "Enabled" if root.enabled else "Disabled"
        on_press: root.enable_clicked()

<ControlWindow>:
    channel1: channel1
    channel2: channel2
    channel3: channel3

    BoxLayout:
        orientation: 'horizontal'
        ChannelControl:
            id: channel1
        ChannelControl:
            id: channel2
        ChannelControl:
            id: channel3



<NumericalValuePopup@Modalview>:
    editBox: editBox

    size_hint: 0.5,0.5
    BoxLayout:
        orientation: 'vertical'
        TextInput:
            id: editBox
        BoxLayout:
            orientation: 'horizontal'
            GridLayout:
                cols: 3
                Button:
                    text: '7'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '8'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '9'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '4'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '5'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '6'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '1'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '2'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '3'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '.'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: '0'
                    on_press: root.key_pressed(self.text)
                Button:
                    text: 'DEL'
                    on_press: root.editBox.do_backspace()
            BoxLayout:
                orientation: 'vertical'
                Button:
                    text: 'A' if root.current_mode else "V"
                    on_press: root.v_pressed()
                Button:
                    text: 'mA' if root.current_mode else "mV"
                    on_press: root.mv_pressed()
                Button:
                    text: 'Cancel'
                    on_press: root.cancel_pressed()
